### 4.5 控制分歧

SIMD执行在warp内所有线程遵循相同执行路径（正式称为控制流）时效果良好。例如，对于一个if-else结构，当warp内所有线程都执行if路径或都执行else路径时，执行效果良好。然而，当warp内的线程采取不同的控制流路径时，SIMD硬件将分别对这些路径进行多次遍历，每个路径进行一次遍历。例如，对于一个if-else结构，如果warp中的一些线程遵循if路径，而其他线程遵循else路径，硬件将进行两次遍历。一次遍历执行遵循if路径的线程，另一次遍历执行遵循else路径的线程。在每次遍历中，遵循另一路径的线程将不会生效。

当同一warp中的线程遵循不同的执行路径时，我们称这些线程表现出控制分歧（control divergence），即它们在执行过程中发生了分歧。对分歧warp执行的多次遍历方法扩展了SIMD硬件实现CUDA线程完整语义的能力。虽然硬件为warp中的所有线程执行相同的指令，但它会选择性地在对应于线程所选择路径的遍历中使这些线程生效，从而允许每个线程看起来像是执行了自己的控制流路径。这在保持线程独立性的同时，利用了SIMD硬件的低成本优势。