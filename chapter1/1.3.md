### 1.3 加速真实应用

我们可以从并行化应用程序中获得多大的加速?计算系统A相对于计算系统B对应用程序的加速比(speedup)定义是:在系统B中执行该应用程序所用的时间与在系统A中执行相同应用程序所用时间的比率。例如,如果一个应用程序在系统A中执行需要10秒,但在系统B中执行需要200秒,那么系统A相对于系统B的执行加速比将是200/10=20,这被称为20倍(20 times)的加速。

并行计算系统相对于串行计算系统可实现的加速取决于应用程序中可并行化的部分。例如,如果可并行化部分所占用的时间百分比为30%,那么并行部分的100倍加速将最多只能减少应用程序总执行时间的29.7%。也就是说,整个应用程序的加速比将只有约1/(1 - 0.297)=1.42倍。事实上,即使在并行部分实现无限量的加速,也只能削减30%的执行时间,最多实现1.43倍的加速。通过并行执行可以实现的加速水平可能会受到应用程序可并行化部分的严重限制,这一事实被称为阿姆达尔定律(Amdahl's Law)([Amdahl, 2013](https://www.researchgate.net/publication/260711393_Computer_Architecture_and_Amdahl%27s_Law))。另一方面,如果99%的执行时间在并行部分,那么并行部分的100倍加速将使应用程序执行时间减少到原来的1.99%。这使得整个应用程序获得了50倍的加速。因此,对于大规模并行处理器来说,应用程序的绝大部分执行时间都在并行部分是非常重要的,这样才能有效地加速其执行。

研究人员已经在某些应用程序中实现了超过100倍的加速。然而，这通常只有在对算法进行增强后再进行广泛的优化和调整，使得超过99.9%的应用程序工作都在并行部分，才能达到这样的效果。

对应用程序可实现的加速水平来说，另一个重要因素是数据从内存读取和写入内存的速度。在实践中，直接对应用程序进行并行化通常会使内存（DRAM）带宽饱和，导致只能实现约10倍的加速。关键在于找出如何绕过内存带宽限制，这涉及到进行多种转换之一，以利用GPU的专用片上内存，从而大幅减少对DRAM的访问次数。然而，为了克服诸如有限的片上内存容量等限制，还必须进一步优化代码。本书的一个重要目标是帮助读者充分理解这些优化技术，并熟练掌握它们的使用。

请记住，相对于单核CPU执行而言所达到的加速水平也可能反映出CPU对该应用程序的适用性。在某些应用中，CPU表现得非常好，这使得使用GPU来提高性能变得更加困难。大多数应用程序都有一些部分可以由CPU更好地执行。我们必须给予CPU公平的执行机会，并确保代码的编写方式使得GPU能够补充CPU的执行，从而恰当地利用结合了CPU和GPU的异构并行计算能力。截至目前，结合多核CPU和众核GPU的大众市场计算系统已经将万亿次级计算带到了笔记本电脑上，并将百亿亿次级计算带到了集群中。

图1.2 展示了一个典型应用程序的主要部分。在实际应用程序中，大部分代码往往是串行的。这些串行部分被比喻为桃子的"核"区域；试图对这些部分应用并行计算技术就像咬到桃核一样——感觉很不好！这些部分很难并行化。CPU通常在这些部分表现得很好。好消息是，尽管这些部分可能占据代码的很大部分，但它们在超级应用程序的执行时间中通常只占很小的比例。

<figure>
    <style>
     hr {
         border: none;
         height: 2px;
         background-color: black;
         margin: 5px auto;
     }
	</style>
    <img src="..\pic\chapter1\fig1.1.png" alt="图1.1">
    <figcaption>
        <p style="font-weight: bold;">
        图片名称
        </p>
       	<hr style="border: none; height: 2px; background-color: black; margin: 5px auto;">
        <p style="font-family: 'Arial', 'Helvetica', sans-serif;color: #808080">
            图片描述
        </p>
    </figcaption>
</figure>