### 2.2 CUDA C程序结构

我们现在准备学习如何编写CUDA C程序，以利用数据并行实现更快的执行速度。CUDA C扩展了流行的ANSI C编程语言，添加了最少的新语法和库函数，使程序员能够针对包含CPU核心和大规模并行GPU的异构计算系统。顾名思义，CUDA C建立在NVIDIA的CUDA平台之上。CUDA目前是大规模并行计算最成熟的框架，广泛应用于高性能计算行业，并在大多数常见操作系统上提供了编译器、调试器和性能分析器等基本工具。

CUDA C程序的结构反映了计算机中主机（CPU）和一个或多个设备（GPU）的共存。每个CUDA C源文件可以包含混合的主机代码和设备代码。默认情况下，任何传统的C程序都是仅包含主机代码的CUDA程序。可以将设备代码添加到任何源文件中。设备代码通过特殊的CUDA C关键词明显标记。设备代码包括以数据并行方式执行的函数或内核。

CUDA程序的执行过程如[图2.3](#fig2.3)所示。执行从主机代码（CPU串行代码）开始。当调用一个内核函数时，在设备上启动大量线程来执行内核。由内核调用启动的所有线程统称为一个网格（grid）。这些线程是CUDA平台中并行执行的主要载体。[图2.3](fig2.3)展示了两个网格线程的执行。我们很快将讨论这些网格是如何组织的。当一个网格中的所有线程完成执行后，该网格终止，执行继续在主机上，直到启动另一个网格。请注意，[图2.3](#fig2.3)显示了一个简化模型，其中CPU执行和GPU执行不重叠。许多异构计算应用程序管理重叠的CPU和GPU执行，以充分利用CPU和GPU的性能。

<figure>
    <style>
     hr {
         border: none;
         height: 2px;
         background-color: black;
         margin: 5px auto;
     }
	</style>
    <img id="fig2.3" src="..\pic\chapter2\fig2.3.jpeg">
    <figcaption>
        <p class="no-indent" style="font-weight: bold;">
        图2.3
        </p>
       	<hr style="border: none; height: 2px; background-color: black; margin: 5px auto;">
        <p class="no-indent" style="font-family: 'Arial', 'Helvetica', sans-serif;color: #808080">
            CUDA程序的执行过程
        </p>
    </figcaption>
</figure>
